<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Component Test - Strategy Builder Wizard</title>
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            margin: 0;
            padding: 20px;
            background: #f5f5f5;
        }
        .test-container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            overflow: hidden;
        }
        .test-header {
            background: #007bff;
            color: white;
            padding: 20px;
            text-align: center;
        }
        .test-content {
            padding: 20px;
        }
        .component-note {
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            border-radius: 4px;
            padding: 15px;
            margin-bottom: 20px;
            color: #856404;
        }
    </style>
</head>
<body>
    <div class="test-container">
        <div class="test-header">
            <h1>Strategy Builder Wizard - Component Test</h1>
            <p>Interactive mockup of the portfolio strategy builder</p>
        </div>

        <div class="test-content">
            <div class="component-note">
                <strong>Note:</strong> This is a standalone test of the Strategy Builder Wizard component.
                The component is fully functional with mock data and interactive elements.
            </div>

            <!-- Component will be mounted here -->
            <div id="strategy-builder-test"></div>
        </div>
    </div>

    <script>
        // Import the StrategyBuilderWizard component code
        const StrategyBuilderWizard = {
            template: `
                <div class="strategy-builder-wizard">
                    <!-- Wizard Header -->
                    <div class="wizard-header">
                        <h2>Portfolio Strategy Builder</h2>
                        <div class="wizard-progress">
                            <div
                                v-for="(step, index) in steps"
                                :key="step.id"
                                :class="['progress-step', { active: currentStep === index, completed: currentStep > index }]"
                            >
                                <div class="step-number">{{ index + 1 }}</div>
                                <span class="step-label">{{ step.label }}</span>
                            </div>
                        </div>
                    </div>

                    <!-- Wizard Content -->
                    <div class="wizard-content">
                        <!-- Step 1: Strategy Type -->
                        <div v-if="currentStep === 0" class="step-container">
                            <h3>Choose Strategy Type</h3>
                            <div class="strategy-options">
                                <div
                                    v-for="strategy in strategyTypes"
                                    :key="strategy.id"
                                    :class="['strategy-card', { selected: selectedStrategy === strategy.id }]"
                                    @click="selectStrategy(strategy.id)"
                                >
                                    <div class="strategy-icon">{{ strategy.icon }}</div>
                                    <h4>{{ strategy.name }}</h4>
                                    <p>{{ strategy.description }}</p>
                                </div>
                            </div>
                        </div>

                        <!-- Step 2: ETF Selection -->
                        <div v-if="currentStep === 1" class="step-container">
                            <h3>Select ETFs</h3>
                            <div class="etf-selection">
                                <div class="etf-categories">
                                    <div
                                        v-for="category in etfCategories"
                                        :key="category.name"
                                        class="category-section"
                                    >
                                        <h4>{{ category.name }}</h4>
                                        <div class="etf-list">
                                            <div
                                                v-for="etf in category.etfs"
                                                :key="etf.ticker"
                                                :class="['etf-item', { selected: selectedETFs.includes(etf.ticker) }]"
                                                @click="toggleETF(etf.ticker)"
                                            >
                                                <span class="etf-ticker">{{ etf.ticker }}</span>
                                                <span class="etf-name">{{ etf.name }}</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Step 3: Allocation Setup -->
                        <div v-if="currentStep === 2" class="step-container">
                            <h3>Set Allocations</h3>
                            <div class="allocation-setup">
                                <div
                                    v-for="etf in selectedETFs"
                                    :key="etf"
                                    class="allocation-item"
                                >
                                    <div class="etf-info">
                                        <span class="ticker">{{ etf }}</span>
                                        <span class="allocation-percentage">{{ allocations[etf] || 0 }}%</span>
                                    </div>
                                    <input
                                        type="range"
                                        min="0"
                                        max="100"
                                        :value="allocations[etf] || 0"
                                        @input="updateAllocation(etf, $event.target.value)"
                                        class="allocation-slider"
                                    />
                                </div>
                                <div class="allocation-summary">
                                    <div :class="['total-percentage', { valid: totalAllocation === 100, invalid: totalAllocation !== 100 }]">
                                        Total: {{ totalAllocation }}%
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Step 4: Review & Save -->
                        <div v-if="currentStep === 3" class="step-container">
                            <h3>Review Strategy</h3>
                            <div class="strategy-review">
                                <div class="strategy-summary">
                                    <h4>Strategy Summary</h4>
                                    <div class="summary-item">
                                        <strong>Type:</strong> {{ getStrategyName(selectedStrategy) }}
                                    </div>
                                    <div class="summary-item">
                                        <strong>ETFs Selected:</strong> {{ selectedETFs.length }}
                                    </div>
                                    <div class="allocations-list">
                                        <h5>Allocations:</h5>
                                        <div
                                            v-for="etf in selectedETFs"
                                            :key="etf"
                                            class="allocation-item"
                                        >
                                            {{ etf }}: {{ allocations[etf] || 0 }}%
                                        </div>
                                    </div>
                                </div>
                                <div class="strategy-name-input">
                                    <label for="strategyName">Strategy Name:</label>
                                    <input
                                        id="strategyName"
                                        v-model="strategyName"
                                        placeholder="e.g., My Custom Portfolio"
                                        class="name-input"
                                    />
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Wizard Navigation -->
                    <div class="wizard-navigation">
                        <button
                            v-if="currentStep > 0"
                            @click="previousStep"
                            class="btn btn-secondary"
                        >
                            Back
                        </button>
                        <button
                            v-if="currentStep < steps.length - 1"
                            @click="nextStep"
                            :disabled="!canProceed"
                            class="btn btn-primary"
                        >
                            Next
                        </button>
                        <button
                            v-if="currentStep === steps.length - 1"
                            @click="saveStrategy"
                            :disabled="!canSave"
                            class="btn btn-success"
                        >
                            Save Strategy
                        </button>
                    </div>
                </div>
            `,
            setup() {
                const { ref, computed, onMounted } = Vue;

                // Wizard state
                const currentStep = ref(0);
                const selectedStrategy = ref('');
                const selectedETFs = ref([]);
                const allocations = ref({});
                const strategyName = ref('');

                // Mock data
                const steps = [
                    { id: 'strategy-type', label: 'Strategy Type' },
                    { id: 'etf-selection', label: 'ETF Selection' },
                    { id: 'allocation', label: 'Allocation' },
                    { id: 'review', label: 'Review' }
                ];

                const strategyTypes = [
                    { id: 'momentum', name: 'Momentum Strategy', description: 'Allocate based on momentum scores', icon: 'ðŸ“ˆ' },
                    { id: 'sma', name: 'SMA Strategy', description: '200-day moving average trend following', icon: 'ðŸ“Š' },
                    { id: 'custom', name: 'Custom Allocation', description: 'Set your own percentage allocations', icon: 'ðŸŽ¯' }
                ];

                const etfCategories = [
                    {
                        name: 'Stocks',
                        etfs: [
                            { ticker: 'VTI', name: 'Vanguard Total Stock Market' },
                            { ticker: 'VEA', name: 'Vanguard Developed Markets' },
                            { ticker: 'VWO', name: 'Vanguard Emerging Markets' }
                        ]
                    },
                    {
                        name: 'Bonds',
                        etfs: [
                            { ticker: 'TLT', name: 'iShares 20+ Year Treasury Bond' },
                            { ticker: 'BND', name: 'Vanguard Total Bond Market' }
                        ]
                    }
                ];

                // Computed properties
                const totalAllocation = computed(() => {
                    return Object.values(allocations.value).reduce((sum, val) => sum + val, 0);
                });

                const canProceed = computed(() => {
                    switch (currentStep.value) {
                        case 0: return selectedStrategy.value !== '';
                        case 1: return selectedETFs.value.length > 0;
                        case 2: return totalAllocation.value === 100;
                        default: return true;
                    }
                });

                const canSave = computed(() => {
                    return strategyName.value.trim() !== '' && totalAllocation.value === 100;
                });

                // Methods
                const selectStrategy = (strategyId) => {
                    selectedStrategy.value = strategyId;
                };

                const toggleETF = (ticker) => {
                    const index = selectedETFs.value.indexOf(ticker);
                    if (index > -1) {
                        selectedETFs.value.splice(index, 1);
                        delete allocations.value[ticker];
                    } else {
                        selectedETFs.value.push(ticker);
                        allocations.value[ticker] = 0;
                    }
                };

                const updateAllocation = (ticker, value) => {
                    allocations.value[ticker] = parseInt(value);
                };

                const getStrategyName = (strategyId) => {
                    const strategy = strategyTypes.find(s => s.id === strategyId);
                    return strategy ? strategy.name : '';
                };

                const nextStep = () => {
                    if (currentStep.value < steps.length - 1) {
                        currentStep.value++;
                    }
                };

                const previousStep = () => {
                    if (currentStep.value > 0) {
                        currentStep.value--;
                    }
                };

                const saveStrategy = () => {
                    console.log('Saving strategy:', {
                        name: strategyName.value,
                        type: selectedStrategy.value,
                        etfs: selectedETFs.value,
                        allocations: allocations.value
                    });
                    alert('Strategy saved successfully! (This is a mockup)');
                };

                return {
                    currentStep,
                    selectedStrategy,
                    selectedETFs,
                    allocations,
                    strategyName,
                    steps,
                    strategyTypes,
                    etfCategories,
                    totalAllocation,
                    canProceed,
                    canSave,
                    selectStrategy,
                    toggleETF,
                    updateAllocation,
                    getStrategyName,
                    nextStep,
                    previousStep,
                    saveStrategy
                };
            }
        };

        // Mount the component
        const { createApp } = Vue;
        createApp(StrategyBuilderWizard).mount('#strategy-builder-test');
    </script>
</body>
</html>